<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>pTolemy3D Demo Page</title>
        <link type="text/css" href="css/south-street/jquery-ui-1.7.2.custom.css" rel="stylesheet" />
        <link href="css/screen.css" rel="stylesheet" type="text/css" media="screen" />

        <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui-1.7.2.custom.min.js"></script>
        <script type="text/javascript">
            $(function(){
                // Accordion
                $("#accordion").accordion({
                    header: "h3",
                    clearStyle: true,
                    autoHeight: false
                });

                // NOTE: The dialog plugin is avoided due problems shown on
                // top of the applet.
                // Dialog
                /*
                $('#dialog').dialog({
                    autoOpen: false,
                    width: 400,
                    buttons: {
                        "Ok": function() {
                            $(this).dialog("close");
                        }
                    }
                });
                // Dialog Link
                $('#dialog_link').click(function(){
                    $('#dialog').dialog('open');
                    return false;
                });
                 */

                // Execute free code
                $("#run_freecode").click(function(){
                    var freecode = $("#freecode").val();
                    eval(freecode);
                });

                // Resize the applet and code window
                $("#freecode").resizable();
                $(".map3dcontainer").resizable();

                // Check if Java plugin is available
                if(checkJava()==false){
                    $(".map3dcontainer").css("background-color","silver");
                }
            });

            /**
             * Checks if Java VM is installed.
             */
            function checkJava()
            {
                var javaEnabled = navigator.javaEnabled();
                if(!javaEnabled){
                    alert("Java VM not installed !!!\npTolemy3D requires Java plugin installed to be executed.");
                }
                return javaEnabled;
            }

            // Reference to pTolemy object.
            var ptolemy = null;

            var init_lat = 132.730000;
            var init_lon = 35.010000;
            var init_alt = 1260000;
            var init_dir = 0;
            var init_pitch = -30;
            var init_atmos = true;
            var init_camx = 0;
            var init_camy = 0;
            var init_terrain_follow = true;
            var init_terrain_scale = 1;
            var init_terrain_status = true;
            var init_horizon = 10000;

            /**
             * Called once the applet is initialized and started.
             */
            function ptolemyStart(){

                alert("ptolemyStart");
                
                // Create a Ptolemy instance from the applet element identifier
                // in the HTML file.
                ptolemy = new ptolemy3d('pTolemy3D');

                // TODO - Seems to return undefinied values.
                // Store inital params to allow reset the scene.
                init_lat = ptolemy.getCamera().getLatitude();
                init_lon = ptolemy.getCamera().getLongitude();
                init_alt = ptolemy.getCamera().getAltitude();
                init_dir = ptolemy.getCamera().getDirection();
                init_pitch = ptolemy.getCamera().getPitch();
                init_camx = ptolemy.getCamera().getCameraPositionX();
                init_camy = ptolemy.getCamera().getCameraPositionY();
                init_terrain_follow = ptolemy.getCamera().getTerrainFollowMode();
                init_atmos = ptolemy.getTerrain().getAtmosphere();
                init_terrain_scale = ptolemy.getTerrain().getTerrainScale();
                init_terrain_status = ptolemy.getTerrain().getTerrainStatus();
                init_horizon = ptolemy.getTerrain().getHorizonAlt();
            }

            function ptolemyStop(){
                alert("ptolemyStop");
            }

            function reset(){

                //ptolemy.getCamera().setOrientation(init_lat, init_lon, init_alt, init_dir, init_pitch);
                ptolemy.getCamera().setLatitude(init_lat);
                ptolemy.getCamera().setLongitude(init_lon);
                ptolemy.getCamera().setAltitude(init_alt);
                ptolemy.getCamera().setDirection(init_dir);
                ptolemy.getCamera().setPitch(init_pitch);
                ptolemy.getCamera().setTerrainFollowMode(init_terrain_follow);
                ptolemy.getTerrain().setTerrainStatus(init_terrain_status);
                ptolemy.getTerrain().setAtmosphere(init_atmos);
                ptolemy.getTerrain().setHorizonAlt(init_horizon);

                var example = "// Use the 'ptolemy' object to interact with the viewer.\n// Put your code here...\n";
                $('#freecode').val(example);
            }
        </script>
    </head>
    <body>

        <!-- HEADER -->
        <div class="header">
            <img style="float:right;" src="images/pTolemy3D_logo.png" width="144" height="48" alt="Logo" longdesc="pTolemy3D Logo" />
            <span class="title">pTolemy3D</span> - <span class="subtitle">Demo site</span>
            <hr color="#339933" size="1px"/>
        </div>

        <!-- MAIN CONTAINER -->
        <div class="maincontainer">

            <!-- 3D VIEWER -->
            <div class="map3dcontainer">
                <applet code="com.sun.opengl.util.JOGLAppletLauncher"
                        align="center" width="100%" height="100%"
                        id="pTolemy3D" Name="pTolemy3DViewer"
                        codebase="./applet/"
                        archive="./jogl.jar,./gluegen-rt.jar,./plugin.jar,./ptolemy-refactor-0.1.1.jar,./citygml4j-0.2.1.jar,./jaxb-api.jar,./jaxb-impl.jar" MAYSCRIPT>
                    <param name="subapplet.classname" VALUE="org.ptolemy3d.Ptolemy3DApplet">
                    <param name="subapplet.displayname" VALUE="pTolemy3D Viewer">
                    <param name="progressbar" value="true">
                    <param name="noddraw.check" value="true">
                    <param name="noddraw.check.silent" value="true">
                    <param name="cache_archive" VALUE="jogl.jar,gluegen-rt.jar,plugin.jar,ptolemy3d-1.0-SNAPSHOT.jar,ptolemy3dplugin-1.0-SNAPSHOT.jar">
                    <param name="cache_archive_ex" VALUE="jogl.jar;preload,gluegen-rt.jar;preload,plugin.jar;preload,ptolemy3d-1.0-SNAPSHOT.jar;preload,ptolemy3dplugin-1.0-SNAPSHOT.jar;preload">

                    <param name="Orientation" value="132730000,35010000,1260000,0,-30">
                    <param name="CenterX" value="0">
                    <param name="CenterY" value="0">
                    <param name="DisplayRatio" value="1">

                    <param name="Server" value="demo.spatialcloud.com">
                    <param name="NumMapDataServers" value="1">
                    <param name="MapDataSvr1" value="ptolemy3d.s3.amazonaws.com">
                    <param name="MapJp2Store1" value="/demo-data/jp2/">
                    <param name="MapDemStore1" value="/demo-data/dem/">
                    <param name="MUrlAppend1" value="&streamID=class64">
                    <param name="MServerKey1" value="">

                    <param name="TileColor" value="47,47,86">
                    <param name="Area" value="00">
                    <param name="Horizon" value="10000">
                    <param name="FlightFrameDelay" value="200">
                    <param name="TIN" value="0">
                    <param name="FollowDEM" value="0">
                    <param name="BackgroundColor" value="0,0,0">

                    <param name="NumLayers" value="5">

                    <param name="LayerWidth_1" value="52428800">
                    <param name="LayerDEM_1" value="9">
                    <param name="LayerMin_1" value="400000">
                    <param name="LayerMax_1" value="10000000">
                    <param name="LayerDivider_1" value="0">

                    <param name="LayerWidth_2" value="6553600">
                    <param name="LayerDEM_2" value="9">
                    <param name="LayerMin_2" value="200000">
                    <param name="LayerMax_2" value="500000">
                    <param name="LayerDivider_2" value="0">

                    <param name="LayerWidth_3" value="819200">
                    <param name="LayerDEM_3" value="9">
                    <param name="LayerMin_3" value="100000">
                    <param name="LayerMax_3" value="250000">
                    <param name="LayerDivider_3" value="0">

                    <param name="LayerWidth_4" value="102400">
                    <param name="LayerDEM_4" value="9">
                    <param name="LayerMin_4" value="20000">
                    <param name="LayerMax_4" value="100000">
                    <param name="LayerDivider_4" value="0">

                    <param name="LayerWidth_5" value="12800">
                    <param name="LayerDEM_5" value="9">
                    <param name="LayerMin_5" value="0">
                    <param name="LayerMax_5" value="10000">
                    <param name="LayerDivider_5" value="0">

                    <param name="NumPlugins" value="0">

                    <param name="PluginType_1" value="org.ptolemy3d.plugin.IconPlugin">
                    <param name="PluginParam_1" value="/Ptolemy_test/new.png,40,0">

                    <param name="PluginType_2" value="org.ptolemy3d.plugin.CityGmlPlugin">
                    <param name="PluginParam_2" value="100000,http://localhost:8080/openbd/CFML/pseudoWFS/wfs.cfm?SERVICE=wfs&amp;REQUEST=GetFeature&amp;bbox=-180,-90,180,90">

                </applet>
            </div>

            <!-- API AND CODE WINDOWS -->
            <table width="100%" border="0">
                <tr>
                    <td width="250px" valign="top">
                        <!-- Every link in the accordion loads a different JS file -->

                        <div id="accordion">
                            <div>
                                <h3><a href="#">Camera:</a></h3>
                                <div>
                                    <ul>
                                        <li><a href="#" onClick="$('#freecode').load('./code/simpleFlight.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Simple flight.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/complexFlight.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Complex flight.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/positioning.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Positioning.</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div>
                                <h3><a href="#">Options:</a></h3>
                                <div>
                                    <ul>
                                        <li><a href="#" onclick="$('#freecode').load('./code/cameraFlightType.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Camera flight type.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/terrainOptions.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Terrain options.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/flightMode.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Terrain flight mode.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/clickMode.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Click mode.</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div>
                                <h3><a href="#" id="dialog_link">Viewer Controls:</a></h3>
                                <div id="dialog" title="Controls">
                                    You can control pTolemy3D viewer using:<br/>
                                    <strong>Keyboard:</strong>
                                    <ul>
                                        <li>a - zoom in</li>
                                        <li>z - zoom out</li>
                                        <li>s - zoom in</li>
                                        <li>x - zoom out</li>
                                        <li>d - rotate left</li>
                                        <li>f - rotate right</li>
                                        <li>r - tilt down</li>
                                        <li>c - tilt up</li>
                                        <li>left arrow - spin globe left</li>
                                        <li>right arrow - spin globe right</li>
                                        <li>up arrow - spin globe up</li>
                                        <li>down arrow - spin globe down</li>
                                    </ul>
                                    <strong>Mouse:</strong>
                                    <ul>
                                        <li>drag - moves camera</li>
                                    </ul>

                                </div>
                            </div>
                        </div>

                    </td>
                    <td valign="top">
                        <textarea id="freecode" cols="110" rows="15">// Use the 'ptolemy' object to interact with the viewer.&#13;// Put your code here...&#13;</textarea><br/>
                        <button id="run_freecode">Run...</button><button id="reset_ptolemy" onclick="reset();">Reset...</button>
                    </td>
                </tr>
            </table>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <hr color="#339933" size="1px"/>
            <p>pTolemy3D Team</p>
        </div>

    </body>
</html>


