<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="keywords" content="pTtolemy3D" />
        <meta name="description" content="pTolemy3D Demo Site" />

        <title>pTolemy3D Demo Site</title>

        <script type="text/javascript" src="jquery-1.2.6.min.js"></script>
        <script type="text/javascript" src="jquery-ui-personalized-1.5.3.min.js"></script>
        <script type="text/javascript" src="ptolemy3d.js"></script>

        <link href="css/ui.all.css" rel="stylesheet" type="text/css" media="screen" />
        <link href="css/screen.css" rel="stylesheet" type="text/css" media="screen" />
        <link href="css/demos.css" rel="stylesheet" type="text/css" media="screen" />

        <script type="text/javascript">
            /**
             * Once the document is ready checks if Java plugin is available and
             * set some jQuery components.
             */
            $(document).ready(function() {

                // Accordion
                $("#accordion").accordion({
                    header: ".ui-accordion-header",
                    clearStyle: true,
                    autoHeight: false
                });

                // Execute free code
                $("#run_freecode").click(function(){
                    var freecode = $("#freecode").val();
                    eval(freecode);
                });

                // Resize the applet and code window
                $("#freecode").resizable();
                $(".map3dcontainer").resizable();

                // Check if Java plugin is available
                if(checkJava()==false){
                    $(".map3dcontainer").css("background-color","silver");
                }
            });

            /**
             * Checks if Java VM is installed.
             */
            function checkJava()
            {
                var javaEnabled = navigator.javaEnabled();
                if(!javaEnabled){
                    alert("Java VM not installed !!!\npTolemy3D requires Java plugin installed to be executed.");
                }
                return javaEnabled;
            }

            // Reference to pTolemy object.
            var ptolemy = null;

            var init_lat = 132.730000;
            var init_lon = 35.010000;
            var init_alt = 1260000;
            var init_dir = 0;
            var init_pitch = -30;
            var init_atmos = true;
            var init_camx = 0;
            var init_camy = 0;
            var init_terrain_follow = true;
            var init_terrain_scale = 1;
            var init_terrain_status = true;
            var init_horizon = 10000;

            /**
             * Called once the applet is initialized and started.
             */
            function ptolemyStart(){
                // Create a Ptolemy instance from the applet element identifier
                // in the HTML file.
                ptolemy = new ptolemy3d('pTolemy3D');

                // TODO - Seems to return undefinied values.
                // Store inital params to allow reset the scene.
                init_lat = ptolemy.getCamera().getLatitude();
                init_lon = ptolemy.getCamera().getLongitude();
                init_alt = ptolemy.getCamera().getAltitude();
                init_dir = ptolemy.getCamera().getDirection();
                init_pitch = ptolemy.getCamera().getPitch();
                init_camx = ptolemy.getCamera().getCameraPositionX();
                init_camy = ptolemy.getCamera().getCameraPositionY();
                init_terrain_follow = ptolemy.getCamera().getTerrainFollowMode();
                init_atmos = ptolemy.getTerrain().getAtmosphere();
                init_terrain_scale = ptolemy.getTerrain().getTerrainScale();
                init_terrain_status = ptolemy.getTerrain().getTerrainStatus();
                init_horizon = ptolemy.getTerrain().getHorizonAlt();
            }

            function reset(){

                //ptolemy.getCamera().setOrientation(init_lat, init_lon, init_alt, init_dir, init_pitch);
                ptolemy.getCamera().setLatitude(init_lat);
                ptolemy.getCamera().setLongitude(init_lon);
                ptolemy.getCamera().setAltitude(init_alt);
                ptolemy.getCamera().setDirection(init_dir);
                ptolemy.getCamera().setPitch(init_pitch);
                ptolemy.getCamera().setTerrainFollowMode(init_terrain_follow);
                ptolemy.getTerrain().setTerrainStatus(init_terrain_status);
                ptolemy.getTerrain().setAtmosphere(init_atmos);
                ptolemy.getTerrain().setHorizonAlt(init_horizon);

                var example = "// Use the 'ptolemy' object to interact with the viewer.\n// Put your code here...\n";
                $('#freecode').val(example);
            }
        </script>
    </head>

    <body>
        <!-- HEADER -->
        <div class="header">
            <img style="float:right;" src="images/pTolemy3D_logo.png" width="144" height="48" alt="Logo" longdesc="pTolemy3D Logo" />
            <span class="title">pTolemy3D</span> - <span class="subtitle">Demo site</span>
            <hr color="#339933" size="1px"/>
        </div>

        <!-- MAIN CONTAINER -->
        <div class="maincontainer">

            <!-- 3D VIEWER -->
            <div class="map3dcontainer">
                <applet code="com.sun.opengl.util.JOGLAppletLauncher"
                        align="center" width="100%" height="100%"
                        id="pTolemy3D" Name="pTolemy3DViewer"
                        codebase="./applet/"
                        archive="./jogl.jar,./gluegen-rt.jar,./plugin.jar,./ptolemy3d-1.0-SNAPSHOT.jar,./ptolemy3dplugin-1.0-SNAPSHOT.jar" MAYSCRIPT>
                    <param name="subapplet.classname" VALUE="org.ptolemy3d.viewer.Ptolemy3DApplet">
                    <param name="subapplet.displayname" VALUE="pTolemy3D Viewer">
                    <param name="progressbar" value="true">
                    <param name="noddraw.check" value="true">
                    <param name="noddraw.check.silent" value="true">
                    <param name="cache_archive" VALUE="jogl.jar,gluegen-rt.jar,plugin.jar,ptolemy3d-1.0-SNAPSHOT.jar,ptolemy3dplugin-1.0-SNAPSHOT.jar">
                    <param name="cache_archive_ex" VALUE="jogl.jar;preload,gluegen-rt.jar;preload,plugin.jar;preload,ptolemy3d-1.0-SNAPSHOT.jar;preload,ptolemy3dplugin-1.0-SNAPSHOT.jar;preload">

                    <param name="Orientation" value="-100000000,40000000,1260000,0,-30">
                    <param name="CenterX" value="0">
                    <param name="CenterY" value="0">
                    <param name="DisplayRatio" value="1">

                    <param name="Server" value="demo.spatialcloud.com">
                    <param name="nMapDataSvr" value="1">
                    <param name="MapDataSvr1" value="ptolemy3d.s3.amazonaws.com">
                    <param name="MapJp2Store1" value="/demo-data/jp2/">
                    <param name="MapDemStore1" value="/demo-data/dem/">
                    <param name="MUrlAppend1" value="&streamID=class64">
                    <param name="MServerKey1" value="">

                    <param name="TILECOLOR" value="47,47,86">
                    <param name="Area" value="00">
                    <param name="HORIZON" value="10000">
                    <param name="FlightFrameDelay" value="200">
                    <param name="TIN" value="1">
                    <param name="FOLLOWDEM" value="0">

                    <param name="Units" value="DD">
                    <param name="BGCOLOR" value="0,0,0">
                    <param name="SubTextures" value="1">

                    <param name="NumLayers" value="5">

                    <param name="LayerWidth_1" value="52428800">
                    <param name="LayerDEM_1" value="9">
                    <param name="LayerMIN_1" value="400000">
                    <param name="LayerMAX_1" value="10000000">
                    <param name="LayerDIVIDER_1" value="0">

                    <param name="LayerWidth_2" value="6553600">
                    <param name="LayerDEM_2" value="9">
                    <param name="LayerMIN_2" value="200000">
                    <param name="LayerMAX_2" value="500000">
                    <param name="LayerDIVIDER_2" value="0">

                    <param name="LayerWidth_3" value="819200">
                    <param name="LayerDEM_3" value="9">
                    <param name="LayerMIN_3" value="100000">
                    <param name="LayerMAX_3" value="250000">
                    <param name="LayerDIVIDER_3" value="0">

                    <param name="LayerWidth_4" value="102400">
                    <param name="LayerDEM_4" value="9">
                    <param name="LayerMIN_4" value="20000">
                    <param name="LayerMAX_4" value="100000">
                    <param name="LayerDIVIDER_4" value="0">

                    <param name="LayerWidth_5" value="12800">
                    <param name="LayerDEM_5" value="9">
                    <param name="LayerMIN_5" value="0">
                    <param name="LayerMAX_5" value="10000">
                    <param name="LayerDIVIDER_5" value="0">

                    <param name="NumPlugins" value="1">

                    <param name="PluginType_1" value="org.ptolemy3d.plugin.HudPlugin">
                    <param name="PluginParam_1" value="-hudPrefix1 Center: -hudPrefix2 Streaming%20Speed: -hudPrefix3 Altitude: -hudSuffix3 meters">

                </applet>
            </div>

            <!-- API AND CODE WINDOWS -->
            <table width="100%" border="0">
                <tr>
                    <td width="250px" valign="top">
                        <!-- Every link in the accordion loads a different JS file -->
                        <div id="accordion"  class="ui-accordion ui-widget" role="tablist">
                            <div class="ui-accordion-group">
                                <h3 class="ui-accordion-header"><a href="#">Camera:</a></h3>
                                <div class="ui-accordion-content">
                                    <ul>
                                        <li><a href="#" onClick="$('#freecode').load('./code/simpleFlight.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Simple flight.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/complexFlight.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Complex flight.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/positioning.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Positioning.</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="ui-accordion-group">
                                <h3 class="ui-accordion-header"><a href="#">Options:</a></h3>
                                <div class="ui-accordion-content">
                                    <ul>
                                        <li><a href="#" onclick="$('#freecode').load('./code/cameraFlightType.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Camera flight type.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/terrainOptions.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Terrain options.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/flightMode.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Terrain flight mode.</a></li>
                                        <li><a href="#" onclick="$('#freecode').load('./code/clickMode.js','',function (responseText, textStatus, XMLHttpRequest) {$('#freecode').val(responseText);});">Click mode.</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="ui-accordion-group">
                                <h3 class="ui-accordion-header"><a href="#">Viewer Controls:</a></h3>
                                <div class="ui-accordion-content">
                                    You can control pTolemy3D viewer using:
                                    <ul>
                                        <li>Keyboard:</li>
                                        <ul>
                                            <li>a - zoom in</li>
                                            <li>z - zoom out</li>
                                            <li>s - zoom in</li>
                                            <li>x - zoom out</li>
                                            <li>d - rotate left</li>
                                            <li>f - rotate right</li>
                                            <li>r - tilt down</li>
                                            <li>c - tilt up</li>
                                            <li>left arrow - spin globe left</li>
                                            <li>right arrow - spin globe right</li>
                                            <li>up arrow - spin globe up</li>
                                            <li>down arrow - spin globe down</li>
                                        </ul>
                                        <li>Mouse:</li>
                                        <ul>
                                            <li>drag - moves camera</li>
                                        </ul>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </td>
                    <td valign="top">
                        <textarea id="freecode" cols="110" rows="15">// Use the 'ptolemy' object to interact with the viewer.&#13;// Put your code here...&#13;</textarea><br/>
                        <button id="run_freecode">Run...</button><button id="reset_ptolemy" onclick="reset();">Reset...</button>
                    </td>
                </tr>
            </table>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <hr color="#339933" size="1px"/>
            <p>pTolemy3D Team</p>
        </div>

    </body>
</html>
